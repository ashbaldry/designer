function htmlToJSON(e,n=!1){var a=getChildrenJSON(e),a={tagName:e.tagName.toLowerCase(),r_function:e.dataset.shinyfunction,r_arguments:e.dataset.shinyattributes,r_comments:e.dataset.shinycomments,text:$(e).ignore().text().replace(/\s*\n\s*/g,""),htmlclass:e.className,children:a};return n?a:JSON.stringify(a)}function getChildrenJSON(e){for(var n,a=[],t=0;t<e.children.length;t++)e.children[t].dataset.shinyfunction?a.push(htmlToJSON(e.children[t],!0)):!e.children[t].children.length||(n=getChildrenJSON(e.children[t])).length&&(a=a.concat(n));return a}$(function(){$(".help-icon").tooltip({boundary:"window",placement:"right"}),$("#settings-page_type").on("change",updateCanvasCheck),updatePage(),$("#confirm_reset").on("click",updatePage),$(".copy-ui-button").on("click",copyUICode),$(document).on("click",".clickable-dropdown",e=>{e.stopPropagation()}),$("#remove_label").on("change",toggleComponentLabels),$("#remove_colour").on("change",toggleBackgroundColours),$("#remove_border").on("change",toggleBorders),$("#preview").on("click",()=>{$(".page-canvas-shell").addClass("preview")}),$("#canvas-close_preview").on("click",()=>{$(".page-canvas-shell").removeClass("preview")}),$("#app_name").on("change keyup",e=>{var n=$(e.target).val();$("#canvas-title").html(n),$(".navbar-brand").html(n),$(".brand-link").html(n),$("#canvas-page").data("shinyattributes")&&(e=$("#canvas-page").data("shinyattributes").replace(/"[^"]+"/,'"'+n+'"'),$("#canvas-page").attr("data-shinyattributes",e)),$("#canvas-page>.main-header").data("shinyattributes")&&(n=$("#canvas-page>.main-header").data("shinyattributes").replace(/"[^"]+"/,'"'+n+'"'),$("#canvas-page>.main-header").attr("data-shinyattributes",n))}),Sortable.create(document.getElementById("sidebar-bin"),{group:{name:"shared",pull:!1},handle:".designer-element",draggable:".designer-element",onAdd:function(e){this.el.removeChild(e.item)}})}),$.fn.ignore=function(e){return this.clone().find(e||">*").remove().end()};var canvasPageBinding=new Shiny.InputBinding;$.extend(canvasPageBinding,{find:function(e){return $(e).find(".page-canvas")},getValue:function(e){return htmlToJSON(document.getElementById("canvas-page"))},setValue:function(e,n){$(e).text(n)},subscribe:function(e,n){const a=new MutationObserver(function(){n()});a.observe(e,{subtree:!0,childList:!0,attributes:!0})},unsubscribe:function(e){$(e).off(".page-canvas")}}),Shiny.inputBindings.register(canvasPageBinding);